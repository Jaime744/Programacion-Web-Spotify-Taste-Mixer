{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///mnt/c/Github/Programacion-Web-Spotify-Taste-Mixer/spotify/src/lib/auth.js"],"sourcesContent":["// Generar string aleatorio para el parámetro 'state'\r\nexport function generateRandomString(length) {\r\n  const possible = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\r\n  let text = '';\r\n  for (let i = 0; i < length; i++) {\r\n    text += possible.charAt(Math.floor(Math.random() * possible.length));\r\n  }\r\n  return text;\r\n}\r\n\r\n// Construir URL de autorización de Spotify\r\nexport function getSpotifyAuthUrl() {\r\n  const clientId = process.env.NEXT_PUBLIC_SPOTIFY_CLIENT_ID || '';\r\n  const redirectUri = process.env.NEXT_PUBLIC_REDIRECT_URI || '';\r\n  const state = generateRandomString(16);\r\n\r\n  // Guardar el state para validación posterior \r\n  if (typeof window !== 'undefined') {  \r\n    localStorage.setItem('spotify_auth_state', state);  \r\n  }\r\n\r\n  const scope = [\r\n    'user-read-private',\r\n    'user-read-email',\r\n    'user-top-read',\r\n    'playlist-modify-public',\r\n    'playlist-modify-private'\r\n  ].join(' ');\r\n\r\n  const params = new URLSearchParams({\r\n    client_id: clientId,\r\n    response_type: 'code',\r\n    redirect_uri: redirectUri,\r\n    state: state,\r\n    scope: scope\r\n  });\r\n\r\n  return `https://accounts.spotify.com/authorize?${params.toString()}`;\r\n}\r\n\r\n// Guardar tokens en localStorage\r\nexport function saveTokens(accessToken, refreshToken, expiresIn) {\r\n  const expirationTime = Date.now() + expiresIn * 1000;\r\n  if (typeof window !== 'undefined') {  \r\n    localStorage.setItem('spotify_token', accessToken);\r\n    localStorage.setItem('spotify_refresh_token', refreshToken);\r\n    localStorage.setItem('spotify_token_expiration', expirationTime.toString());\r\n  }\r\n}\r\n\r\n// Obtener token actual (con verificación de expiración)\r\nexport function getAccessToken() {\r\n  \r\n  if (typeof window === \"undefined\") {\r\n    return null;  \r\n  }\r\n\r\n  const token = localStorage.getItem('spotify_token');\r\n  const expiration = localStorage.getItem('spotify_token_expiration');\r\n  \r\n  if (!token || !expiration) return null;\r\n\r\n  // Si el token expiro, retorno null\r\n  if (Date.now() > parseInt(expiration)) {\r\n    return null;\r\n  }\r\n\r\n  return token;\r\n}\r\n\r\n// Verificar si hay token válido\r\nexport function isAuthenticated() {\r\n  return getAccessToken() !== null;\r\n}\r\n\r\n// Cerrar sesión\r\nexport function logout() {\r\n  if (typeof window !== 'undefined') {  // Solo ejecutamos esto en el cliente\r\n    localStorage.removeItem('spotify_token');\r\n    localStorage.removeItem('spotify_refresh_token');\r\n    localStorage.removeItem('spotify_token_expiration');\r\n  }\r\n}\r\n"],"names":[],"mappings":"AAAA,qDAAqD;;;;;;;;;;;;;;;AAYlC;AAXZ,SAAS,qBAAqB,MAAM;IACzC,MAAM,WAAW;IACjB,IAAI,OAAO;IACX,IAAK,IAAI,IAAI,GAAG,IAAI,QAAQ,IAAK;QAC/B,QAAQ,SAAS,MAAM,CAAC,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,SAAS,MAAM;IACpE;IACA,OAAO;AACT;AAGO,SAAS;IACd,MAAM,WAAW,wEAA6C;IAC9D,MAAM,cAAc,2EAAwC;IAC5D,MAAM,QAAQ,qBAAqB;IAEnC,8CAA8C;IAC9C,wCAAmC;QACjC,aAAa,OAAO,CAAC,sBAAsB;IAC7C;IAEA,MAAM,QAAQ;QACZ;QACA;QACA;QACA;QACA;KACD,CAAC,IAAI,CAAC;IAEP,MAAM,SAAS,IAAI,gBAAgB;QACjC,WAAW;QACX,eAAe;QACf,cAAc;QACd,OAAO;QACP,OAAO;IACT;IAEA,OAAO,CAAC,uCAAuC,EAAE,OAAO,QAAQ,IAAI;AACtE;AAGO,SAAS,WAAW,WAAW,EAAE,YAAY,EAAE,SAAS;IAC7D,MAAM,iBAAiB,KAAK,GAAG,KAAK,YAAY;IAChD,wCAAmC;QACjC,aAAa,OAAO,CAAC,iBAAiB;QACtC,aAAa,OAAO,CAAC,yBAAyB;QAC9C,aAAa,OAAO,CAAC,4BAA4B,eAAe,QAAQ;IAC1E;AACF;AAGO,SAAS;IAEd;;IAIA,MAAM,QAAQ,aAAa,OAAO,CAAC;IACnC,MAAM,aAAa,aAAa,OAAO,CAAC;IAExC,IAAI,CAAC,SAAS,CAAC,YAAY,OAAO;IAElC,mCAAmC;IACnC,IAAI,KAAK,GAAG,KAAK,SAAS,aAAa;QACrC,OAAO;IACT;IAEA,OAAO;AACT;AAGO,SAAS;IACd,OAAO,qBAAqB;AAC9B;AAGO,SAAS;IACd,wCAAmC;QACjC,aAAa,UAAU,CAAC;QACxB,aAAa,UAAU,CAAC;QACxB,aAAa,UAAU,CAAC;IAC1B;AACF","debugId":null}},
    {"offset": {"line": 89, "column": 0}, "map": {"version":3,"sources":["file:///mnt/c/Github/Programacion-Web-Spotify-Taste-Mixer/spotify/src/components/widgets/ArtistWidget.jsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport axios from \"axios\";\n\n// función que coge de la api los artistas mas escuchados y te lo muestra\nexport default function ArtistWidget({ accessToken }) {\n  const [artists, setArtists] = useState([]);\n\n  useEffect(() => {\n    const fetchArtists = async () => {\n      const response = await axios.get(\"https://api.spotify.com/v1/me/top/artists\", {\n        headers: {\n          Authorization: `Bearer ${accessToken}`,\n        },\n      });\n      setArtists(response.data.items);\n    };\n\n    if (accessToken) {\n      fetchArtists();\n    }\n  }, [accessToken]);\n\n  return (\n    <div className=\"widget\">\n      <h2>Top Artists</h2>\n      <ul>\n        {artists.map((artist) => (\n          <li key={artist.id}>\n            <img src={artist.images[0]?.url} alt={artist.name} width={50} />\n            <span>{artist.name}</span>\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;;AAGe,SAAS,aAAa,EAAE,WAAW,EAAE;;IAClD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC,EAAE;IAEzC,IAAA,0KAAS;kCAAC;YACR,MAAM;uDAAe;oBACnB,MAAM,WAAW,MAAM,mJAAK,CAAC,GAAG,CAAC,6CAA6C;wBAC5E,SAAS;4BACP,eAAe,CAAC,OAAO,EAAE,aAAa;wBACxC;oBACF;oBACA,WAAW,SAAS,IAAI,CAAC,KAAK;gBAChC;;YAEA,IAAI,aAAa;gBACf;YACF;QACF;iCAAG;QAAC;KAAY;IAEhB,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;0BAAG;;;;;;0BACJ,6LAAC;0BACE,QAAQ,GAAG,CAAC,CAAC,uBACZ,6LAAC;;0CACC,6LAAC;gCAAI,KAAK,OAAO,MAAM,CAAC,EAAE,EAAE;gCAAK,KAAK,OAAO,IAAI;gCAAE,OAAO;;;;;;0CAC1D,6LAAC;0CAAM,OAAO,IAAI;;;;;;;uBAFX,OAAO,EAAE;;;;;;;;;;;;;;;;AAQ5B;GA/BwB;KAAA","debugId":null}},
    {"offset": {"line": 180, "column": 0}, "map": {"version":3,"sources":["file:///mnt/c/Github/Programacion-Web-Spotify-Taste-Mixer/spotify/src/app/dashboard/page.js"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { isAuthenticated } from '@/lib/auth';  \nimport ArtistWidget from '../../components/widgets/ArtistWidget';  \n\n\nexport default function Dashboard() {\n  const router = useRouter();\n  const [accessToken, setAccessToken] = useState(null);\n\n  useEffect(() => {\n    // Si no está autenticado, redirigir al login\n    if (!isAuthenticated()) {\n      router.push('/');  \n    } else {\n      const token = localStorage.getItem('spotify_token');\n      setAccessToken(token);  \n    }\n  }, [router]);\n\n  if (!accessToken) {\n    return <div>Loading...</div>;  \n  }\n\n  return (\n    <div>\n      <h1>Dashboard</h1>\n      <ArtistWidget accessToken={accessToken} />\n      \n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;;;AALA;;;;;AAQe,SAAS;;IACtB,MAAM,SAAS,IAAA,kJAAS;IACxB,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAC;IAE/C,IAAA,0KAAS;+BAAC;YACR,6CAA6C;YAC7C,IAAI,CAAC,IAAA,wIAAe,KAAI;gBACtB,OAAO,IAAI,CAAC;YACd,OAAO;gBACL,MAAM,QAAQ,aAAa,OAAO,CAAC;gBACnC,eAAe;YACjB;QACF;8BAAG;QAAC;KAAO;IAEX,IAAI,CAAC,aAAa;QAChB,qBAAO,6LAAC;sBAAI;;;;;;IACd;IAEA,qBACE,6LAAC;;0BACC,6LAAC;0BAAG;;;;;;0BACJ,6LAAC,2JAAY;gBAAC,aAAa;;;;;;;;;;;;AAIjC;GAzBwB;;QACP,kJAAS;;;KADF","debugId":null}}]
}