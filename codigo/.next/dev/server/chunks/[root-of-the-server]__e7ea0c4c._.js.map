{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///mnt/c/Github/Programacion-Web-Spotify-Taste-Mixer/spotify/src/app/api/spotify-token/route.js"],"sourcesContent":["import { NextResponse } from 'next/server';\r\n\r\nexport async function POST(request) {\r\n  try {\r\n    const { code } = await request.json();\r\n\r\n    if (!code) {\r\n      return NextResponse.json(\r\n        { error: 'Código no proporcionado' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    const clientId = process.env.SPOTIFY_CLIENT_ID;\r\n    const clientSecret = process.env.SPOTIFY_CLIENT_SECRET;\r\n    const redirectUri = process.env.NEXT_PUBLIC_REDIRECT_URI;\r\n\r\n    // Intercambiar código por tokens\r\n    const response = await fetch('https://accounts.spotify.com/api/token', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/x-www-form-urlencoded',\r\n        'Authorization': 'Basic ' + Buffer.from(\r\n          `${clientId}:${clientSecret}`\r\n        ).toString('base64')\r\n      },\r\n      body: new URLSearchParams({\r\n        grant_type: 'authorization_code',\r\n        code: code,\r\n        redirect_uri: redirectUri\r\n      })\r\n    });\r\n\r\n    const data = await response.json();\r\n\r\n    if (!response.ok) {\r\n      return NextResponse.json(\r\n        { error: data.error_description || 'Error al obtener token' },\r\n        { status: response.status }\r\n      );\r\n    }\r\n\r\n    return NextResponse.json({\r\n      access_token: data.access_token,\r\n      refresh_token: data.refresh_token,\r\n      expires_in: data.expires_in\r\n    });\r\n\r\n  } catch (error) {\r\n    console.error('Error en token exchange:', error);\r\n    return NextResponse.json(\r\n      { error: 'Error interno del servidor' },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,KAAK,OAAO;IAChC,IAAI;QACF,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEnC,IAAI,CAAC,MAAM;YACT,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA0B,GACnC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,WAAW,QAAQ,GAAG,CAAC,iBAAiB;QAC9C,MAAM,eAAe,QAAQ,GAAG,CAAC,qBAAqB;QACtD,MAAM;QAEN,iCAAiC;QACjC,MAAM,WAAW,MAAM,MAAM,0CAA0C;YACrE,QAAQ;YACR,SAAS;gBACP,gBAAgB;gBAChB,iBAAiB,WAAW,OAAO,IAAI,CACrC,GAAG,SAAS,CAAC,EAAE,cAAc,EAC7B,QAAQ,CAAC;YACb;YACA,MAAM,IAAI,gBAAgB;gBACxB,YAAY;gBACZ,MAAM;gBACN,cAAc;YAChB;QACF;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAEhC,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO,KAAK,iBAAiB,IAAI;YAAyB,GAC5D;gBAAE,QAAQ,SAAS,MAAM;YAAC;QAE9B;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,cAAc,KAAK,YAAY;YAC/B,eAAe,KAAK,aAAa;YACjC,YAAY,KAAK,UAAU;QAC7B;IAEF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA6B,GACtC;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}